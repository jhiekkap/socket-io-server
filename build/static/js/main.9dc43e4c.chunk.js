(this["webpackJsonpsocket-io-client"]=this["webpackJsonpsocket-io-client"]||[]).push([[0],{41:function(e,t,n){e.exports=n(84)},46:function(e,t,n){},77:function(e,t){},84:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(35),i=n.n(r),l=(n(46),n(1)),o=n(3),u=n.n(o);var s=n(97),m=function(e){var t=e.currentUser,n=e.receiver,r=Object(a.useRef)(),i=Object(a.useRef)(),o=Object(a.useState)([]),s=Object(l.a)(o,2),m=s[0],d=s[1];return Object(a.useEffect)((function(){r.current.width=180,r.current.height=150;var e=r.current.getContext("2d");console.log("CANVASREF",r),console.log("CONTEX",e),e.width=r.current.width,e.height=r.current.height;var a=u()("https://fierce-beach-86051.herokuapp.com/",{query:{chatID:t}});function c(e){console.log(e)}return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(e){return function(e){try{i.current.srcObject=e}catch(t){i.current.src=URL.createObjectURL(e)}c("Camera connected")}(e)})).catch((function(e){c("Camera not connected"),d((function(t){return t.concat(e)}))})),setInterval((function(){!function(e,c){c.drawImage(e,0,0,c.width,c.height),a.emit("send_message",{senderChatID:t,receiverChatID:n,videoStream:r.current.toDataURL("image/webp")})}(i.current,e)}),.1),function(){return a.disconnect()}}),[t,n]),c.a.createElement("div",null,c.a.createElement("video",{ref:i,src:"",width:"180",height:"150",autoPlay:!0}),c.a.createElement("canvas",{ref:r}),c.a.createElement("ul",null,m.map((function(e,t){return c.a.createElement("li",{key:t},e)}))))},d=function(e){var t=e.imgRef,n=e.videoSender;return c.a.createElement("div",null,c.a.createElement("img",{ref:t,width:"150",height:"120",alt:"view"}),n)},E="https://fierce-beach-86051.herokuapp.com/",h={heart:"\u2764\ufe0f\ufe0f",happy:"\ud83d\ude0a",sad:"\u2639\ufe0f"},f=["Jari","Sampsa","Kasperi","Janina"];function v(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)([]),o=Object(l.a)(i,2),v=o[0],b=o[1],p=Object(a.useState)(f[0]),g=Object(l.a)(p,2),j=g[0],O=g[1],S=Object(a.useState)(f[1]),C=Object(l.a)(S,2),I=C[0],y=C[1],k=Object(a.useState)(""),w=Object(l.a)(k,2),L=w[0],D=w[1],A=Object(a.useState)(null),R=Object(l.a)(A,2),T=(R[0],R[1],Object(a.useState)(50)),x=Object(l.a)(T,2),U=(x[0],x[1],Object(a.useState)(50)),N=Object(l.a)(U,2),J=(N[0],N[1],Object(a.useState)(!1)),K=Object(l.a)(J,2),P=K[0],F=K[1],_=Object(a.useState)(""),M=Object(l.a)(_,2),V=M[0],q=M[1],z=Object(a.useState)(""),B=Object(l.a)(z,2),H=(B[0],B[1],Object(a.useState)("")),W=Object(l.a)(H,2),Y=W[0],X=W[1],$=Object(a.useRef)(),G={cursor:"pointer",marginRight:"2%",fontSize:P&&"20px"};console.log("CURRENT USER: ",j),console.log("RECIPIENTS: ",L),Object(a.useEffect)((function(){console.log("USE EFFECT");var e=u()(E,{query:{chatID:j}});return e.on("receive_message",(function(e){e.content?b((function(t){return t.concat(e.senderChatID+"=> "+e.receiverChatID+": "+e.content)})):e.emoiji?(F(!0),q(e.emoiji),setTimeout((function(){F(!1),q("")}),2e3)):e.videoStream&&($.current.src=e.videoStream,Y!==e.senderChatID&&X(e.senderChatID))})),function(){return e.disconnect()}}),[j,I]);var Q=function(e){u()(E).emit("send_message",{receiverChatID:I,senderChatID:j,recipients:L,emoiji:e})};return c.a.createElement("div",{style:{padding:"5%"}},c.a.createElement(s.a,{container:!0,spacing:3},c.a.createElement(s.a,{item:!0,md:6},c.a.createElement(m,{currentUser:j,receiver:I}),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),u()(E).emit("send_message",{receiverChatID:I,senderChatID:j,content:n,recipients:L}),b((function(e){return e.concat(j+"=> "+I+": "+n)})),r("")}},c.a.createElement("div",null,c.a.createElement("div",null,"L\xc4HETT\xc4J\xc4"),c.a.createElement("select",{value:j,onChange:function(e){return O(e.target.value)}},f.map((function(e,t){return c.a.createElement("option",{key:t},e)})))),c.a.createElement("br",null),c.a.createElement("div",null,c.a.createElement("div",null,"VASTAANOTTAJA"),c.a.createElement("select",{value:I,onChange:function(e){return y(e.target.value)}},f.map((function(e,t){return c.a.createElement("option",{key:t},e)})))),c.a.createElement("br",null),c.a.createElement("div",null,c.a.createElement("div",null,"VIESTI"),c.a.createElement("input",{type:"text",value:n,onChange:function(e){return r(e.target.value)}}),c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement("button",{type:"submit",disabled:!j},"PUSH ME")),c.a.createElement("br",null),c.a.createElement("div",null,c.a.createElement("input",{type:"checkbox",checked:"ALL"!==L,onChange:function(){return D("ALL"!==L?"ALL":"")},name:"recipients"}),c.a.createElement("label",null,"YKSITYINEN"),c.a.createElement("input",{type:"checkbox",checked:"ALL"===L,onChange:function(){return D("ALL"===L?"":"ALL")},name:"recipients"}),c.a.createElement("label",null,"KAIKKI")))),c.a.createElement("br",null),c.a.createElement("div",null,c.a.createElement("span",{onClick:function(){return Q("heart")},style:G}," \u2764\ufe0f\ufe0f "),c.a.createElement("span",{onClick:function(){return Q("happy")},style:G}," \ud83d\ude0a "),c.a.createElement("span",{onClick:function(){return Q("sad")},style:G}," \u2639\ufe0f ")),c.a.createElement("div",null,c.a.createElement("ul",null,v.map((function(e,t){return c.a.createElement("li",{key:t},e)})))),V&&c.a.createElement("div",{style:{position:"fixed",top:"50px",right:"50px",fontSize:"300px"}},h[V])),c.a.createElement(s.a,{item:!0,md:6,style:{display:Y?"block":"none"}},c.a.createElement(d,{imgRef:$,videoSender:Y}))))}var b=function(){var e=Object(a.useState)(!0),t=Object(l.a)(e,2),n=t[0],r=t[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{onClick:function(){return r((function(e){return!e}))}},"STOPPA CLIENTEN"),n?c.a.createElement(v,null):null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(b,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[41,1,2]]]);
//# sourceMappingURL=main.9dc43e4c.chunk.js.map